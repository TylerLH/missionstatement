{% extends "layout.html" %}

{% block scripts %}
	<script type="text/javascript">
		document.addEventListener('keydown', function (event) {
		  var esc = event.which == 27,
		      nl = event.which == 13,
		      el = event.target,
		      input = el.nodeName != 'INPUT' && el.nodeName != 'TEXTAREA',
		      data = {};

		  if (input) {
		    if (esc) {
		      // restore state
		      document.execCommand('undo');
		      el.blur();
		    } else if (nl) {
		      // save
		      data['csrf_token'] = '{{ form.csrf_token }}';
		      data[el.getAttribute('data-name')] = el.innerHTML;

		      // we could send an ajax request to update the field
		      /*
		      $.ajax({
		        url: window.location.toString(),
		        data: data,
		        type: 'post'
		      });
		      */
		      log(JSON.stringify(data));

		      el.blur();
		      event.preventDefault();
		    }
		  }
		}, true);

		function log(s) {
		  console.log('value changed to: ' + s);
		}
	</script>
{% endblock %}

{% block content %}
	<form class="offset2" method="POST">
	    {{ form.csrf_token }}
	      <div class="input">
		    {{ form.title.label }} {{ form.title(size=50,id="title",class="span7 char_limited",autocomplete="off") }}
		    <span class="help-inline"><span class="units-left">50</span> character<span class="plural">s</span> <span class="too-much">left</span></span>
		  </div>
          <div class="input">
            {{ form.tagline.label}} {{ form.tagline(size=10,id="tagline",class="span7 word_limited",autocomplete="off")}}
            <span class="help-inline"><span class="units-left">10</span> word<span class="plural">s</span> <span class="too-much">left</span></span>
          </div>
		  <div class="input">
		  	{{ form.tweet.label}} {{ form.tweet(size=140,id="tweet",class="span7 autoresize char_limited",autocomplete="off")}}
		  	<span class="help-inline"><span class="units-left">140</span> character<span class="plural">s</span> <span class="too-much">left</span></span>
		  </div>
          <div class="input">
            {{ form.blurb.label}} {{ form.blurb(size=100,id="blurb",class="span7 autoresize word_limited",autocomplete="off")}}
            <span class="help-inline"><span class="units-left">100</span> word<span class="plural">s</span> <span class="too-much">left</span></span>
          </div>
          <div class="container btn-toolbar">
            <div class="span7">
               {% if update %}
<!--                     <button name="update" value="_update" type="submit" class="btn btn-primary btn-small"><i class="icon-white icon-check"></i> Update</button> -->
<!--                    <button class="btn btn-small btn-success"><i class="icon-bookmark"></i> Bookmark</button> -->
    
                   
                    <button name="email" value="_email" type="submit" class="pull-right send-project btn btn-small btn-success"><i class="icon-white icon-envelope"></i> Send Link</button>
                    {{ form.email_addr(placeholder="me@example.com",class="pull-right sendto", type="email")}}
               {% else %}
                   <button type="submit" class="btn btn-primary btn-small"><i class="icon-white icon-check"></i> Save</button>
               {% endif %}
            </div>
          </div>
	</form>
{% endblock %}